{% extends 'base.html' %}

{% block title %}{{ product.NombreProducto }}{% endblock %}

{% block content %}
    <div class="container mt-5 mb-5">
        <div class="row">
            {# Columna para las imágenes del producto #}
            <div class="col-md-6">
                <div class="card shadow rounded-3 mb-4">
                    <div class="card-body p-3">
                        {# Imagen principal del producto #}
                        <div class="main-image-container text-center mb-3">
                            {% if images %}
                                <img id="mainProductImage" src="{{ url_for('static', filename=images[0]) }}" 
                                     class="img-fluid rounded-3" alt="{{ product.NombreProducto }}" 
                                     style="max-height: 450px; object-fit: contain;">
                            {% else %}
                                <img id="mainProductImage" src="{{ url_for('static', filename='img/default.jpg') }}" 
                                     class="img-fluid rounded-3" alt="Imagen no disponible" 
                                     style="max-height: 450px; object-fit: contain;">
                            {% endif %}
                        </div>

                        {# Miniaturas de las imágenes #}
                        {% if images|length > 1 %}
                        <div class="row g-2 justify-content-center">
                            {% for image_url in images %}
                            <div class="col-3 col-sm-2 col-md-3 col-lg-2">
                                <img src="{{ url_for('static', filename=image_url) }}" 
                                     class="img-thumbnail rounded-3 thumbnail-image" 
                                     alt="Miniatura {{ loop.index }}" 
                                     style="height: 80px; object-fit: cover; cursor: pointer;"
                                     onclick="changeMainImage(this.src)">
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            {# Columna para los detalles del producto y añadir al carrito #}
            <div class="col-md-6">
                <div class="card shadow rounded-3 p-4">
                    <div class="card-body">
                        <h1 class="card-title display-5 mb-3">{{ product.NombreProducto }}</h1>
                        <p class="text-muted fs-5 mb-3">{{ product.Categoria }}</p>
                        <h2 class="card-text text-danger fw-bold mb-4">${{ "%.0f" | format(product.Precio) }}</h2>
                        
                        <p class="card-text mb-4">{{ product.DescripcionProducto }}</p>

                        <div class="mb-4">
                            <span class="fw-bold">Disponibilidad:</span> 
                            {% if product.CantidadStock > 0 %}
                                <span class="text-success">En Stock ({{ product.CantidadStock }} unidades)</span>
                            {% else %}
                                <span class="text-danger">Agotado</span>
                            {% endif %}
                        </div>

                        {# Formulario para añadir al carrito #}
                        <form action="" method="POST" class="mb-5">
                            <div class="mb-3">
                                <label for="quantity" class="form-label">Cantidad:</label>
                                <input type="number" id="quantity" name="quantity" class="form-control w-auto d-inline-block rounded-3" 
                                       value="1" min="1" max="" 
                                       {% if product.CantidadStock == 0 %}disabled{% endif %} required>
                            </div>
                            <button type="submit" class="btn btn-danger btn-lg w-100 rounded-3">
                                <i class="bi bi-cart-plus me-2"></i> Añadir al Carrito
                            </button>
                        </form>

                        {# Botón para volver a la página principal #}
                        <div class="text-center mt-3">
                            <a href="{{ url_for('home.index') }}" class="btn btn-outline-secondary rounded-3">
                                <i class="bi bi-arrow-left me-2"></i> Volver a la Tienda
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
    {# JavaScript para cambiar la imagen principal #}
    <script>
        function changeMainImage(src) {
            document.getElementById('mainProductImage').src = src;
        }
    </script>
{% endblock %}


